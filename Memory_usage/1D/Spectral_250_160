<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<style>
.r1 {color: #005f00; text-decoration-color: #005f00}
.r2 {font-weight: bold}
.r3 {color: #000080; text-decoration-color: #000080; font-weight: bold}
.r4 {color: #87af00; text-decoration-color: #87af00; font-weight: bold}
.r5 {color: #005f00; text-decoration-color: #005f00; font-weight: bold}
.r6 {color: #7f7f7f; text-decoration-color: #7f7f7f; font-weight: bold}
.r7 {color: #000080; text-decoration-color: #000080; font-weight: bold; font-style: italic}
.r8 {color: #87af00; text-decoration-color: #87af00; font-weight: bold; font-style: italic}
.r9 {color: #005f00; text-decoration-color: #005f00; font-weight: bold; font-style: italic}
.r10 {color: #7f7f7f; text-decoration-color: #7f7f7f}
.r11 {color: #000080; text-decoration-color: #000080}
.r12 {color: #87af00; text-decoration-color: #87af00}
.r13 {color: #800000; text-decoration-color: #800000; font-weight: bold}
.r14 {color: #000000; text-decoration-color: #000000; background-color: #f8f8f8}
.r15 {color: #ba2121; text-decoration-color: #ba2121; background-color: #f8f8f8}
.r16 {color: #666666; text-decoration-color: #666666; background-color: #f8f8f8}
.r17 {font-style: italic}
.r18 {color: #008000; text-decoration-color: #008000; background-color: #f8f8f8}
.r19 {color: #008000; text-decoration-color: #008000; background-color: #f8f8f8; font-weight: bold}
.r20 {color: #bbbbbb; text-decoration-color: #bbbbbb; background-color: #f8f8f8}
.r21 {color: #0000ff; text-decoration-color: #0000ff; background-color: #f8f8f8; font-weight: bold}
.r22 {background-color: #f8f8f8}
.r23 {color: #000080; text-decoration-color: #000080; text-decoration: underline}
body {
    color: #000000;
    background-color: #ffffff;
}
</style>
</head>
<body>
    <pre style="font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><code style="font-family:inherit">                          Memory usage: <span class="r1">▃▃▃▃▃▃▃▃▃▃██▃▃███▆█▇▅▅▇▅▇▅▃</span> (max: 694.591 MB, growth rate:   0%)                           
             /home/soham/Git/spectral-NN/Memory_usage/spect_NN.py: % of time = 100.00% (6m:34.116s) out of 6m:34.116s.             
       ╷       ╷       ╷      ╷       ╷       ╷       ╷               ╷       ╷                                                    
 <span class="r2">      </span>│<span class="r3">Time</span><span class="r2">   </span>│<span class="r3">––––––</span><span class="r2"> </span>│<span class="r3">––––…</span><span class="r2"> </span>│<span class="r4">––––––</span><span class="r2"> </span>│<span class="r5">Memory</span><span class="r2"> </span>│<span class="r5">––––––</span><span class="r2"> </span>│<span class="r5">–––––––––––</span><span class="r2">    </span>│<span class="r4">Copy</span><span class="r2">   </span>│<span class="r2">                                                   </span> 
 <span class="r2"> </span><span class="r6">Line</span><span class="r2"> </span>│<span class="r7">Python</span><span class="r2"> </span>│<span class="r7">native</span><span class="r2"> </span>│<span class="r7">syst…</span><span class="r2"> </span>│<span class="r8">GPU</span><span class="r2">    </span>│<span class="r9">Python</span><span class="r2"> </span>│<span class="r9">peak</span><span class="r2">   </span>│<span class="r9">timeline</span><span class="r5">/%</span><span class="r2">     </span>│<span class="r8">(MB/s)</span><span class="r2"> </span>│<span class="r2">/home/soham/Git/spectral-NN/Memory_usage/spect_NN… </span> 
╺━━━━━━┿━━━━━━━┿━━━━━━━┿━━━━━━┿━━━━━━━┿━━━━━━━┿━━━━━━━┿━━━━━━━━━━━━━━━┿━━━━━━━┿━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╸
 <span class="r10">  ... </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">      </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│                                                    
 <span class="r10">   11 </span>│<span class="r13">    4%</span><span class="r11"> </span>│<span class="r13">   93%</span><span class="r11"> </span>│<span class="r11">   3% </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│<span class="r14">    spect_multirun(</span><span class="r15">&quot;Deep&quot;</span><span class="r14">,M</span><span class="r16">=10</span><span class="r14">,L</span><span class="r16">=10</span><span class="r14">,depth</span><span class="r16">=4</span><span class="r14">,width</span><span class="r16">=</span>  
 <span class="r10">  ... </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">      </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│                                                    
       ╵       ╵       ╵      ╵       ╵       ╵       ╵               ╵       ╵                                                    
<span class="r17">         /home/soham/Git/spectral-NN/source_codes/Important_functions.py: % of time =   0.00% (0.000ms) out of 6m:34.116s.         </span>
       ╷       ╷       ╷      ╷       ╷       ╷       ╷               ╷       ╷                                                    
 <span class="r2">      </span>│<span class="r3">Time</span><span class="r2">   </span>│<span class="r3">––––––</span><span class="r2"> </span>│<span class="r3">––––…</span><span class="r2"> </span>│<span class="r4">––––––</span><span class="r2"> </span>│<span class="r5">Memory</span><span class="r2"> </span>│<span class="r5">––––––</span><span class="r2"> </span>│<span class="r5">–––––––––––</span><span class="r2">    </span>│<span class="r4">Copy</span><span class="r2">   </span>│<span class="r2">                                                   </span> 
 <span class="r2"> </span><span class="r6">Line</span><span class="r2"> </span>│<span class="r7">Python</span><span class="r2"> </span>│<span class="r7">native</span><span class="r2"> </span>│<span class="r7">syst…</span><span class="r2"> </span>│<span class="r8">GPU</span><span class="r2">    </span>│<span class="r9">Python</span><span class="r2"> </span>│<span class="r9">peak</span><span class="r2">   </span>│<span class="r9">timeline</span><span class="r5">/%</span><span class="r2">     </span>│<span class="r8">(MB/s)</span><span class="r2"> </span>│<span class="r2">/home/soham/Git/spectral-NN/source_codes/Importan… </span> 
╺━━━━━━┿━━━━━━━┿━━━━━━━┿━━━━━━┿━━━━━━━┿━━━━━━━┿━━━━━━━┿━━━━━━━━━━━━━━━┿━━━━━━━┿━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╸
 <span class="r10">  ... </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">      </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│                                                    
 <span class="r10">  126 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">      </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">  215M </span>│<span class="r1">▁▁▁▁▁▁▁▁▁   1% </span>│<span class="r12">       </span>│<span class="r14">            a1 </span><span class="r16">=</span><span class="r14"> torch</span><span class="r16">.</span><span class="r14">sum(I11[h1:,h2:]</span><span class="r16">*</span><span class="r14">I11[:</span><span class="r16">-</span><span class="r14">h1,:</span>  
 <span class="r10">  127 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">      </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">  215M </span>│<span class="r1">▁▁▁▁▁▁▁▁▁      </span>│<span class="r12">     1 </span>│<span class="r14">            a2 </span><span class="r16">=</span><span class="r14"> torch</span><span class="r16">.</span><span class="r14">sum(I22[h1:,h2:]</span><span class="r16">*</span><span class="r14">I22[:</span><span class="r16">-</span><span class="r14">h1,:</span>  
 <span class="r10">  128 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">      </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">  215M </span>│<span class="r1">▁▁▁▁▁▁▁▁▁      </span>│<span class="r12">     1 </span>│<span class="r14">            a3 </span><span class="r16">=</span><span class="r14"> torch</span><span class="r16">.</span><span class="r14">sum(I12[h1:,h2:]</span><span class="r16">*</span><span class="r14">I12[:</span><span class="r16">-</span><span class="r14">h1,:</span>  
 <span class="r10">  129 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">      </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">  215M </span>│<span class="r1">▁▁▁▁▁▁▁▁▁      </span>│<span class="r12">     3 </span>│<span class="r14">            a4 </span><span class="r16">=</span><span class="r14"> torch</span><span class="r16">.</span><span class="r14">sum(I12[h2:,h1:]</span><span class="r16">*</span><span class="r14">I12[:</span><span class="r16">-</span><span class="r14">h2,:</span>  
 <span class="r10">  ... </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">      </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│                                                    
 <span class="r10">  257 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">      </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">  335M </span>│<span class="r1">▁▁▁▁▁▁▁▁▁  10% </span>│<span class="r12">       </span>│<span class="r14">            ah_uv </span><span class="r16">=</span><span class="r14"> torch</span><span class="r16">.</span><span class="r14">einsum(</span><span class="r15">&quot;ijklm, ikn, jln </span>  
 <span class="r10">  ... </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">      </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│                                                    
       ╵       ╵       ╵      ╵       ╵       ╵       ╵               ╵       ╵                                                    
Top PEAK memory consumption, by line:
<span class="r1">(1)   257:   335 MB</span>                                                                                                                 
<span class="r1">(2)   128:   215 MB</span>                                                                                                                 
<span class="r1">(3)   126:   215 MB</span>                                                                                                                 
<span class="r1">(4)   127:   215 MB</span>                                                                                                                 
<span class="r1">(5)   129:   215 MB</span>                                                                                                                 
<span class="r17">          /home/soham/Git/spectral-NN/source_codes/SpectralNetworks.py: % of time =   0.00% (0.000ms) out of 6m:34.116s.           </span>
       ╷       ╷       ╷      ╷       ╷       ╷       ╷               ╷       ╷                                                    
 <span class="r2">      </span>│<span class="r3">Time</span><span class="r2">   </span>│<span class="r3">––––––</span><span class="r2"> </span>│<span class="r3">––––…</span><span class="r2"> </span>│<span class="r4">––––––</span><span class="r2"> </span>│<span class="r5">Memory</span><span class="r2"> </span>│<span class="r5">––––––</span><span class="r2"> </span>│<span class="r5">–––––––––––</span><span class="r2">    </span>│<span class="r4">Copy</span><span class="r2">   </span>│<span class="r2">                                                   </span> 
 <span class="r2"> </span><span class="r6">Line</span><span class="r2"> </span>│<span class="r7">Python</span><span class="r2"> </span>│<span class="r7">native</span><span class="r2"> </span>│<span class="r7">syst…</span><span class="r2"> </span>│<span class="r8">GPU</span><span class="r2">    </span>│<span class="r9">Python</span><span class="r2"> </span>│<span class="r9">peak</span><span class="r2">   </span>│<span class="r9">timeline</span><span class="r5">/%</span><span class="r2">     </span>│<span class="r8">(MB/s)</span><span class="r2"> </span>│<span class="r2">/home/soham/Git/spectral-NN/source_codes/Spectral… </span> 
╺━━━━━━┿━━━━━━━┿━━━━━━━┿━━━━━━┿━━━━━━━┿━━━━━━━┿━━━━━━━┿━━━━━━━━━━━━━━━┿━━━━━━━┿━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╸
 <span class="r10">  ... </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">      </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│                                                    
 <span class="r10">   68 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">      </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">  695M </span>│<span class="r1">▂▂▂▂▂▂▂▂▂  28% </span>│<span class="r12">       </span>│<span class="r14">        u1 </span><span class="r16">=</span><span class="r14"> </span><span class="r18">self</span><span class="r16">.</span><span class="r14">act_fn(torch</span><span class="r16">.</span><span class="r14">einsum(</span><span class="r15">&quot;ijkl,ml -&gt; </span>  
 <span class="r10">  ... </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">      </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│                                                    
 <span class="r10">   70 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">      </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">  695M </span>│<span class="r1">▅▅▅▄▄▃▄▃▄  56% </span>│<span class="r12">       </span>│<span class="r14">            u1 </span><span class="r16">=</span><span class="r14"> </span><span class="r18">self</span><span class="r16">.</span><span class="r14">act_fn(torch</span><span class="r16">.</span><span class="r14">einsum(</span><span class="r15">&quot;ijkl, i</span>  
 <span class="r10">   71 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">      </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">  695M </span>│<span class="r1">▁▁▁▁▁▁▁▁▁      </span>│<span class="r12">       </span>│<span class="r14">        </span><span class="r19">return</span><span class="r14"> </span><span class="r18">self</span><span class="r16">.</span><span class="r14">act_fn(torch</span><span class="r16">.</span><span class="r14">einsum(</span><span class="r15">&quot;ijk,ijkm </span>  
 <span class="r10">  ... </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">      </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│                                                    
 <span class="r10">   74 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">      </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">  215M </span>│<span class="r1">▁▁▁▁▁▁▁▁▁   3% </span>│<span class="r12">       </span>│<span class="r14">        </span><span class="r19">return</span><span class="r14"> torch</span><span class="r16">.</span><span class="r14">einsum(</span><span class="r15">&quot;ij,ijk -&gt; k&quot;</span><span class="r14">, </span><span class="r18">self</span><span class="r16">.</span><span class="r14">xi</span>  
 <span class="r10">  ... </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">      </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│                                                    
       ╵       ╵       ╵      ╵       ╵       ╵       ╵               ╵       ╵                                                    
Top PEAK memory consumption, by line:
<span class="r1">(1)    70:   695 MB</span>                                                                                                                 
<span class="r1">(2)    71:   695 MB</span>                                                                                                                 
<span class="r1">(3)    68:   695 MB</span>                                                                                                                 
<span class="r1">(4)    74:   215 MB</span>                                                                                                                 
<span class="r17">        /home/soham/Git/spectral-NN/source_codes/spectral_NN_multirun.py: % of time =   0.00% (0.000ms) out of 6m:34.116s.         </span>
       ╷       ╷       ╷      ╷       ╷       ╷       ╷               ╷       ╷                                                    
 <span class="r2">      </span>│<span class="r3">Time</span><span class="r2">   </span>│<span class="r3">––––––</span><span class="r2"> </span>│<span class="r3">––––…</span><span class="r2"> </span>│<span class="r4">––––––</span><span class="r2"> </span>│<span class="r5">Memory</span><span class="r2"> </span>│<span class="r5">––––––</span><span class="r2"> </span>│<span class="r5">–––––––––––</span><span class="r2">    </span>│<span class="r4">Copy</span><span class="r2">   </span>│<span class="r2">                                                   </span> 
 <span class="r2"> </span><span class="r6">Line</span><span class="r2"> </span>│<span class="r7">Python</span><span class="r2"> </span>│<span class="r7">native</span><span class="r2"> </span>│<span class="r7">syst…</span><span class="r2"> </span>│<span class="r8">GPU</span><span class="r2">    </span>│<span class="r9">Python</span><span class="r2"> </span>│<span class="r9">peak</span><span class="r2">   </span>│<span class="r9">timeline</span><span class="r5">/%</span><span class="r2">     </span>│<span class="r8">(MB/s)</span><span class="r2"> </span>│<span class="r2">/home/soham/Git/spectral-NN/source_codes/spectral… </span> 
╺━━━━━━┿━━━━━━━┿━━━━━━━┿━━━━━━┿━━━━━━━┿━━━━━━━┿━━━━━━━┿━━━━━━━━━━━━━━━┿━━━━━━━┿━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╸
 <span class="r10">  ... </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">      </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│                                                    
 <span class="r10">    5 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">      </span>│<span class="r12">       </span>│<span class="r1">  55%  </span>│<span class="r1">  113M </span>│<span class="r1">▁▁▁▁▁▁▁▁▁      </span>│<span class="r12">     3 </span>│<span class="r14">    </span><span class="r19">import</span><span class="r20"> </span><span class="r21">torch</span><span class="r22">                                  </span>  
 <span class="r10">  ... </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">      </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│                                                    
 <span class="r10">   83 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">      </span>│<span class="r12">       </span>│<span class="r1">  99%  </span>│<span class="r1">   50M </span>│<span class="r1">▁▁▁▁▁          </span>│<span class="r12">     2 </span>│<span class="r14">        optimizer </span><span class="r16">=</span><span class="r14"> setup</span><span class="r16">.</span><span class="r14">optimizer(model</span><span class="r16">.</span><span class="r14">params,l</span>  
 <span class="r10">  ... </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">      </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">               </span>│<span class="r12">       </span>│                                                    
       ╵       ╵       ╵      ╵       ╵       ╵       ╵               ╵       ╵                                                    
Top PEAK memory consumption, by line:
<span class="r1">(1)     5:   113 MB</span>                                                                                                                 
<span class="r1">(2)    83:    50 MB</span>                                                                                                                 
generated by the <a class="r23" href="https://github.com/plasma-umass/scalene">scalene</a> profiler                                                                                                   
</code></pre>
</body>
</html>
