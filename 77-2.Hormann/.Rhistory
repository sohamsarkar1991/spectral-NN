source('loaddata.R')
library(fda)
# Import PM10 data
pm<-read.csv(file="data/pm10.txt",header = TRUE)
pm.graz<-pm[,4+2] - pm[,4+3]
# N = number of grid points = 48 (half-hourly observations)
# n = number of functional observations = length(pm[,4])/48
N=48
n=length(pm.graz)/48
# Transform the Graz data to matrix (48x182)
pm.discrete=matrix(pm.graz,nrow=N,ncol=n) 
pm.discrete=pm.discrete[,-(90:96)]
# Remove mean and weekend effects
seven=seq(1:25)*7
six=seq(1:25)*7-1
five=seq(1:25)*7-2
four=seq(1:25)*7-3
three=seq(1:25)*7-4
two=seq(1:25)*7-5
one=seq(1:25)*7-6
# Transformation to functional data
nrows = 48
n = 175
nbasis = 15
#Psi = matrix(c(0,0.3,0,-0.3,0,0,0,0,0),ncol=3)
Psi = "unknown"
set.seed(20)
T = 200
basis = create.fourier.basis(rangeval=c(0, 1), nbasis=nbasis)
source('loaddata.R')
source('pm10.R')
q()
ls()
rm(list = ls())
ls()
source('pm10.R')
q()
